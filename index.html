<!DOCTYPE html>
<html lang="ko">
<head>
    <meta charset="UTF-8">
    <title>Yuzu Survivor</title>
    <script src="https://cdn.jsdelivr.net/npm/phaser@3.60.0/dist/phaser-arcade-physics.min.js"></script>
    <style>
        body { margin: 0; display: flex; justify-content: center; align-items: center; height: 100vh; background-color: #222; }
        canvas { border: 2px solid #fff; }
    </style>
</head>
<body>
    <script>
        // 이 자리에 아까 작성한 JS 코드를 넣습니다.
        const config = {
            type: Phaser.AUTO,
            width: 800,
            height: 600,
            physics: { default: 'arcade', arcade: { debug: false } },
            scene: { preload: preload, create: create, update: update }
        };

        const game = new Phaser.Game(config);
        let player, enemies, weapons, cursors;
        let weaponLevel = 1;
        let lastFired = 0;

        function preload() {
            this.load.image('main_yuzu', 'main_yuzu.webp');
            this.load.image('enemy_wild_yuzu', 'enemy_wildyuzu.webp'); // 오타 수정: enemy_wildyuzu
            this.load.image('weapon_gyul', 'weapon_gyul.webp');
        }

        function create() {
            player = this.physics.add.sprite(400, 300, 'main_yuzu');
            player.setCollideWorldBounds(true);
            enemies = this.physics.add.group();
            weapons = this.physics.add.group({ defaultKey: 'weapon_gyul', maxSize: 30 });
            
            this.time.addEvent({ delay: 1000, callback: spawnEnemy, callbackScope: this, loop: true });
            cursors = this.input.keyboard.createCursorKeys();
            this.physics.add.overlap(weapons, enemies, hitEnemy, null, this);
        }

        function update(time) {
            player.setVelocity(0);
            if (cursors.left.isDown) player.setVelocityX(-160);
            else if (cursors.right.isDown) player.setVelocityX(160);
            if (cursors.up.isDown) player.setVelocityY(-160);
            else if (cursors.down.isDown) player.setVelocityY(160);

            if (time > lastFired) fireGyul(time, this);

            enemies.getChildren().forEach(enemy => {
                this.physics.moveToObject(enemy, player, 80);
            });
        }

        function fireGyul(time, scene) {
            const shootCount = weaponLevel;
            for (let i = 0; i < shootCount; i++) {
                let gyul = weapons.get(player.x, player.y);
                if (gyul) {
                    gyul.setActive(true).setVisible(true);
                    const angle = (i * 0.2) - (shootCount * 0.1);
                    scene.physics.moveTo(gyul, player.x + 100, player.y + (angle * 100), 300);
                    scene.time.delayedCall(2000, () => { gyul.setActive(false).setVisible(false); });
                }
            }
            lastFired = time + 1000;
        }

        function spawnEnemy() {
            const x = Phaser.Math.Between(0, 800);
            const y = Phaser.Math.Between(0, 600);
            enemies.create(x, y, 'enemy_wild_yuzu');
        }

        function hitEnemy(weapon, enemy) {
            weapon.setActive(false).setVisible(false);
            enemy.destroy();
        }
    </script>
</body>
</html>
